(function(e){function t(t){for(var r,o,u=t[0],s=t[1],c=t[2],f=0,l=[];f<u.length;f++)o=u[f],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&l.push(a[o][0]),a[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);d&&d(t);while(l.length)l.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var u=n[o];0!==a[u]&&(r=!1)}r&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},a={app:0},i=[];function o(e){return c.p+"js/"+({about:"about"}[e]||e)+"."+{about:"0d75c327","chunk-682b4002":"a11e0de9"}[e]+".js"}var u={};var s={a5c3:function(){return{"./index_bg.js":{__wbindgen_object_drop_ref:function(e){return r["6119"].exports["bb"](e)},__wbindgen_string_new:function(e,t){return r["6119"].exports["cb"](e,t)},__wbg_new_59cb74e423758ede:function(){return r["6119"].exports["I"]()},__wbg_stack_558ba5917b466edd:function(e,t){return r["6119"].exports["O"](e,t)},__wbg_error_4bb6c2a97407129a:function(e,t){return r["6119"].exports["s"](e,t)},__wbg_instanceof_Window_17fdb5cd280d476d:function(e){return r["6119"].exports["F"](e)},__wbg_document_c26d0f423c143e0c:function(e){return r["6119"].exports["p"](e)},__wbg_getElementById_df597d226f179219:function(e,t,n){return r["6119"].exports["v"](e,t,n)},__wbg_instanceof_WebGlRenderingContext_f732dd95c50b903a:function(e){return r["6119"].exports["E"](e)},__wbg_bufferData_a513e51e685294ae:function(e,t,n,a){return r["6119"].exports["f"](e,t,n,a)},__wbg_texImage2D_f4f837ad2dcc6a75:function(e,t,n,a,i,o,u,s,c,f,l){return r["6119"].exports["P"](e,t,n,a,i,o,u,s,c,f,l)},__wbg_activeTexture_ee6eed2472803dd2:function(e,t){return r["6119"].exports["b"](e,t)},__wbg_attachShader_c2f7771e6f4b91d8:function(e,t,n){return r["6119"].exports["c"](e,t,n)},__wbg_bindBuffer_f4ad79795655c1c4:function(e,t,n){return r["6119"].exports["d"](e,t,n)},__wbg_bindTexture_751d66bbae4822ab:function(e,t,n){return r["6119"].exports["e"](e,t,n)},__wbg_clear_42b42c27d041ce11:function(e,t){return r["6119"].exports["j"](e,t)},__wbg_clearColor_ba6ba6886092ab6a:function(e,t,n,a,i){return r["6119"].exports["i"](e,t,n,a,i)},__wbg_compileShader_8aec8947f553f5b6:function(e,t){return r["6119"].exports["k"](e,t)},__wbg_createBuffer_f26187e1b465a677:function(e){return r["6119"].exports["l"](e)},__wbg_createProgram_10f7bf07e21fe904:function(e){return r["6119"].exports["m"](e)},__wbg_createShader_4060106dc88c8bca:function(e,t){return r["6119"].exports["n"](e,t)},__wbg_createTexture_d7a4df257a9410a7:function(e){return r["6119"].exports["o"](e)},__wbg_drawElements_90d9e4b571f4de3d:function(e,t,n,a,i){return r["6119"].exports["q"](e,t,n,a,i)},__wbg_enableVertexAttribArray_2e2bfba7f3a5fb74:function(e,t){return r["6119"].exports["r"](e,t)},__wbg_getAttribLocation_ea61e93124c45a64:function(e,t,n,a){return r["6119"].exports["t"](e,t,n,a)},__wbg_getProgramInfoLog_ebcdc102c402de8d:function(e,t,n){return r["6119"].exports["w"](e,t,n)},__wbg_getProgramParameter_02e369d0fe1637e6:function(e,t,n){return r["6119"].exports["x"](e,t,n)},__wbg_getShaderInfoLog_932172511c0dfdb7:function(e,t,n){return r["6119"].exports["y"](e,t,n)},__wbg_getShaderParameter_4306f019f7eb9f82:function(e,t,n){return r["6119"].exports["z"](e,t,n)},__wbg_getUniformLocation_277279212040ec65:function(e,t,n,a){return r["6119"].exports["A"](e,t,n,a)},__wbg_linkProgram_9258ef1fcd3afc43:function(e,t){return r["6119"].exports["G"](e,t)},__wbg_shaderSource_ef8be775578bf902:function(e,t,n,a){return r["6119"].exports["N"](e,t,n,a)},__wbg_texParameteri_e2db4aa7650962eb:function(e,t,n,a){return r["6119"].exports["Q"](e,t,n,a)},__wbg_uniform1f_fb0383a4c61faacf:function(e,t,n){return r["6119"].exports["R"](e,t,n)},__wbg_uniform1i_595e085d9c3aadf2:function(e,t,n){return r["6119"].exports["S"](e,t,n)},__wbg_useProgram_67487c5ef197884d:function(e,t){return r["6119"].exports["T"](e,t)},__wbg_vertexAttribPointer_52d124f67ddb572d:function(e,t,n,a,i,o,u){return r["6119"].exports["U"](e,t,n,a,i,o,u)},__wbg_viewport_5f99aff932f780aa:function(e,t,n,a,i){return r["6119"].exports["V"](e,t,n,a,i)},__wbg_log_eb1108411ecc4a7f:function(e){return r["6119"].exports["H"](e)},__wbg_instanceof_HtmlCanvasElement_ff7be16a6a6bdf51:function(e){return r["6119"].exports["D"](e)},__wbg_getContext_0dcf09cb63d08f77:function(e,t,n){return r["6119"].exports["u"](e,t,n)},__wbg_newnoargs_8aad4a6554f38345:function(e,t){return r["6119"].exports["J"](e,t)},__wbg_call_1f85aaa5836dfb23:function(e,t){return r["6119"].exports["h"](e,t)},__wbg_self_c0d3a5923e013647:function(){return r["6119"].exports["M"]()},__wbg_window_7ee6c8be3432927d:function(){return r["6119"].exports["W"]()},__wbg_globalThis_c6de1d938e089cf0:function(){return r["6119"].exports["B"]()},__wbg_global_c9a01ce4680907f8:function(){return r["6119"].exports["C"]()},__wbindgen_is_undefined:function(e){return r["6119"].exports["Y"](e)},__wbg_buffer_eb5185aa4a8e9c62:function(e){return r["6119"].exports["g"](e)},__wbg_newwithbyteoffsetandlength_772fe1865bed3e65:function(e,t,n){return r["6119"].exports["K"](e,t,n)},__wbg_newwithbyteoffsetandlength_a31622ccc380e8b4:function(e,t,n){return r["6119"].exports["L"](e,t,n)},__wbindgen_object_clone_ref:function(e){return r["6119"].exports["ab"](e)},__wbindgen_boolean_get:function(e){return r["6119"].exports["X"](e)},__wbindgen_throw:function(e,t){return r["6119"].exports["db"](e,t)},__wbindgen_memory:function(){return r["6119"].exports["Z"]()}}}}};function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=a[e]=[t,r]}));t.push(n[2]=r);var i,f=document.createElement("script");f.charset="utf-8",f.timeout=120,c.nc&&f.setAttribute("nonce",c.nc),f.src=o(e);var l=new Error;i=function(t){f.onerror=f.onload=null,clearTimeout(_);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",l.name="ChunkLoadError",l.type=r,l.request=i,n[1](l)}a[e]=void 0}};var _=setTimeout((function(){i({type:"timeout",target:f})}),12e4);f.onerror=f.onload=i,document.head.appendChild(f)}var d={"chunk-682b4002":["a5c3"]}[e]||[];return d.forEach((function(e){var n=u[e];if(n)t.push(n);else{var r,a=s[e](),i=fetch(c.p+""+{a5c3:"c82fceacf45e74baa225"}[e]+".module.wasm");if(a instanceof Promise&&"function"===typeof WebAssembly.compileStreaming)r=Promise.all([WebAssembly.compileStreaming(i),a]).then((function(e){return WebAssembly.instantiate(e[0],e[1])}));else if("function"===typeof WebAssembly.instantiateStreaming)r=WebAssembly.instantiateStreaming(i,a);else{var o=i.then((function(e){return e.arrayBuffer()}));r=o.then((function(e){return WebAssembly.instantiate(e,a)}))}t.push(u[e]=r.then((function(t){return c.w[e]=(t.instance||t).exports})))}})),Promise.all(t)},c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/falling-sand-game-wasm/",c.oe=function(e){throw console.error(e),e},c.w={};var f=window["webpackJsonp"]=window["webpackJsonp"]||[],l=f.push.bind(f);f.push=t,f=f.slice();for(var _=0;_<f.length;_++)t(f[_]);var d=l;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"3bcd":function(e,t,n){},"5b92":function(e,t,n){"use strict";var r=n("3bcd"),a=n.n(r);a.a},"5c0b":function(e,t,n){"use strict";var r=n("9c0c"),a=n.n(r);a.a},"9c0c":function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r,a,i=n("2b0e"),o=n("5f5b"),u=(n("f9e3"),n("2dd8"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("b-container",{attrs:{fluid:""}},[n("router-view")],1)],1)}),s=[],c=(n("5c0b"),n("2877")),f={},l=Object(c["a"])(f,u,s,!1,null,null,null),_=l.exports,d=(n("d3b7"),n("8c4f")),b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("Game")],1)},p=[],h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{attrs:{fluid:""}},[n("b-navbar",{ref:"navbar",attrs:{toggleable:"lg",type:"dark",variant:"dark"}},[n("b-navbar-brand",{attrs:{href:"#"}},[e._v("Sand Game")]),n("b-navbar-toggle",{attrs:{target:"particle-type-collapse"},scopedSlots:e._u([{key:"default",fn:function(t){t.expanded;return[n("b-button",[e._v(" "+e._s(e.particleTypeAsString(e.particleType))+" ")])]}}])}),n("b-navbar-toggle",{attrs:{target:"brush-size-collapse"},scopedSlots:e._u([{key:"default",fn:function(t){t.expanded;return[n("b-button",[e._v(" "+e._s(e.brushSizeAsString(e.brushSize))+" ")])]}}])}),n("b-navbar-toggle",{attrs:{target:"debug-collapse"},scopedSlots:e._u([{key:"default",fn:function(t){t.expanded;return[n("b-button",[e._v(" Debug ")])]}}])}),n("b-collapse",{attrs:{id:"particle-type-collapse","is-nav":""}},[n("b-navbar-nav",{staticClass:"ml-auto"},e._l(e.particleTypes,(function(t){return n("b-nav-item",{key:"particle-type-"+t,attrs:{active:t==e.particleType},on:{click:function(n){return e.selectType(t)}}},[e._v(e._s(e.particleTypeAsString(t)))])})),1)],1),n("b-collapse",{attrs:{id:"brush-size-collapse","is-nav":""}},[n("b-navbar-nav",{staticClass:"ml-auto"},e._l(e.brushSizes,(function(t){return n("b-nav-item",{key:"brush-size-"+t,attrs:{active:t==e.brushSize},on:{click:function(n){return e.setBrushSize(t)}}},[e._v(e._s(e.brushSizeAsString(t)))])})),1)],1),n("b-collapse",{attrs:{id:"debug-collapse","is-nav":""}},[n("b-navbar-nav",{staticClass:"ml-auto"},[n("b-nav-item",{on:{click:e.clear}},[e._v("Clear")]),n("b-nav-item",{on:{click:e.debugFill}},[e._v("Fill")])],1)],1)],1),n("div",{ref:"canvascontainer",attrs:{id:"canvas-container"}},[n("canvas",{ref:"canvas",attrs:{id:"canvas",width:e.canvasWidth,height:e.canvasHeight},on:{mousemove:e.onMouseMove,mousedown:e.onMouseDown,mouseup:e.onMouseUp,touchstart:e.onTouchStart,touchend:e.onTouchEnd,touchmove:e.onTouchMove}},[e._v("rip")])])],1)},g=[],v=(n("4de4"),n("d81d"),n("a9e3"),n("b64b"),n("b85c")),m=(n("96cf"),n("1da1")),w=n("d4ec"),y=n("bee2"),x=n("262e"),S=n("2caf"),k=n("9ab4"),T=n("60a3");(function(e){e[e["Empty"]=0]="Empty",e[e["Wall"]=1]="Wall",e[e["Sand"]=2]="Sand",e[e["Water"]=3]="Water",e[e["Plant"]=4]="Plant",e[e["Fire"]=5]="Fire",e[e["Oil"]=6]="Oil"})(r||(r={})),function(e){e[e["Tiny"]=1]="Tiny",e[e["Small"]=3]="Small",e[e["Medium"]=5]="Medium",e[e["Large"]=8]="Large",e[e["ExtraLarge"]=10]="ExtraLarge"}(a||(a={}));var W=function(e){Object(x["a"])(i,e);var t=Object(S["a"])(i);function i(){var e;return Object(w["a"])(this,i),e=t.apply(this,arguments),e.gameWidth=256,e.gameHeight=256,e.windowWidth=window.innerWidth,e.windowHeight=window.innerHeight,e._canvasWidth=1,e._canvasHeight=1,e.canvasScaleX=1,e.canvasScaleY=1,e.canvas=void 0,e.mouseX=0,e.mouseY=0,e.drawing=!1,e.touching=!1,e.brushSize=5,e.particleType=r.Sand,e}return Object(y["a"])(i,[{key:"mounted",value:function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.canvas=this.$refs.canvas,this.setupCanvas(),window.addEventListener("resize",this.onResize),e.next=5,this.loadWasm();case 5:this.setupGame(),this.updateScaling(),requestAnimationFrame(this.renderLoop);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"beforeDestroy",value:function(){this._canvasWidth=1,this._canvasHeight=1,this.canvasScaleX=1,this.canvasScaleY=1,window.removeEventListener("resize",this.onResize)}},{key:"onResize",value:function(){this.updateScaling()}},{key:"setupCanvas",value:function(){this._canvasWidth=this.gameWidth,this._canvasHeight=this.gameHeight}},{key:"updateScaling",value:function(){var e=this.$refs.canvascontainer,t=window.innerWidth/this.gameWidth,n=(window.innerHeight-e.offsetTop)/this.gameHeight;this.canvasScaleX=t,this.canvasScaleY=n,this.sandGame.update_viewport(this.canvasWidth,this.canvasHeight)}},{key:"loadWasm",value:function(){var e=Object(m["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.e("chunk-682b4002").then(n.bind(null,"eb6b"));case 2:t=e.sent,this.wasm=t;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"onMouseMove",value:function(e){this.mouseX=Math.floor(e.offsetX/this.canvasScaleX),this.mouseY=Math.floor(e.offsetY/this.canvasScaleY)}},{key:"onMouseDown",value:function(){this.drawing=!0}},{key:"onMouseUp",value:function(){this.drawing=!1}},{key:"onTouchStart",value:function(e){e.preventDefault(),this.onTouchMove(e),this.drawing=!0}},{key:"onTouchEnd",value:function(e){e.preventDefault(),this.drawing=!1}},{key:"onTouchCancel",value:function(e){e.preventDefault(),this.drawing=!1}},{key:"onTouchMove",value:function(e){var t,n,r,a;e.preventDefault();var i,o=null!==(t=null===(n=this.canvas)||void 0===n?void 0:n.getBoundingClientRect().left)&&void 0!==t?t:0,u=null!==(r=null===(a=this.canvas)||void 0===a?void 0:a.getBoundingClientRect().top)&&void 0!==r?r:0,s=Object(v["a"])(e.changedTouches);try{for(s.s();!(i=s.n()).done;){var c=i.value,f=Math.floor((c.pageX-o)/this.canvasScaleX),l=Math.floor((c.pageY-u)/this.canvasScaleY);this.mouseX=f,this.mouseY=l}}catch(_){s.e(_)}finally{s.f()}}},{key:"setupGame",value:function(){this.sandGame=this.wasm.SandGame.new(this.gameWidth,this.gameHeight),this.sandGame.initialize_webgl()}},{key:"draw",value:function(e,t){for(var n=this.brushSize,r=-n;r<=n;++r)for(var a=-n;a<=n;++a)if(a*a+r*r<=n*n){if(e+a<2||e+a>this.gameWidth-2||t+r<1||t+r>this.gameHeight-2)continue;this.sandGame.spawn(e+a,t+r,this.particleType)}}},{key:"renderLoop",value:function(){this.drawing&&this.draw(this.mouseX,this.mouseY),this.sandGame.step(),this.sandGame.render(),requestAnimationFrame(this.renderLoop)}},{key:"selectType",value:function(e){this.particleType=e}},{key:"particleTypeAsString",value:function(e){return r[e]}},{key:"debugFill",value:function(){for(var e=1;e<this.gameHeight-1;++e)for(var t=1;t<this.gameWidth-1;++t){var n=0==~~(2*Math.random())?r.Sand:r.Water;this.sandGame.spawn(t,e,n)}}},{key:"clear",value:function(){for(var e=1;e<this.gameHeight-1;++e)for(var t=1;t<this.gameWidth-1;++t)this.sandGame.spawn(t,e,r.Empty)}},{key:"setBrushSize",value:function(e){this.brushSize=e}},{key:"brushSizeAsString",value:function(e){switch(e){case 1:return"Tiny";case 3:return"Small";case 5:return"Medium";case 8:return"Large";case 10:return"Extra Large";default:return"undefined"}}},{key:"canvasWidth",get:function(){return this._canvasWidth*this.canvasScaleX}},{key:"canvasHeight",get:function(){return this._canvasHeight*this.canvasScaleY}},{key:"particleTypes",get:function(){return Object.keys(r).filter((function(e){return!isNaN(Number(e))})).map((function(e){return Number(e)}))}},{key:"brushSizes",get:function(){return Object.keys(a).filter((function(e){return!isNaN(Number(e))})).map((function(e){return Number(e)}))}}]),i}(T["b"]);W=Object(k["a"])([T["a"]],W);var j=W,O=j,M=(n("5b92"),Object(c["a"])(O,h,g,!1,null,"36c78a54",null)),P=M.exports,z={name:"Home",components:{Game:P}},A=z,E=Object(c["a"])(A,b,p,!1,null,null,null),H=E.exports;i["default"].use(d["a"]);var L=[{path:"/",name:"Home",component:H},{path:"/about",name:"About",component:function(){return n.e("about").then(n.bind(null,"f820"))}}],C=new d["a"]({mode:"history",base:"/falling-sand-game-wasm/",routes:L}),G=C,X=n("2f62");i["default"].use(X["a"]);var Y=new X["a"].Store({state:{},mutations:{},actions:{},modules:{}});i["default"].config.productionTip=!1,i["default"].use(o["a"]),new i["default"]({router:G,store:Y,render:function(e){return e(_)}}).$mount("#app")}});
//# sourceMappingURL=app.aeefadba.js.map